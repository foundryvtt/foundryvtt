<h2 class="border">Foundry Virtual Tabletop - Version 9 Patch 2 Release Notes</h2>
<figure>
    <img alt="Release Notes for Foundry Virtual Tabletop Version 9" src="https://r2.foundryvtt.com/website-uploads-public/screen/user_1/v9-stable-patch-2-release-banner-2022-01-26.jpg" title="Foundry VTT - Version 9 Patch 2 (9.245) Release Notes"/>
    <figcaption>Welcome to the Foundry Virtual Tabletop update notes for Version 9 Stable.</figcaption>
</figure>

<p>Hello Foundry Virtual Tabletop community! We are pleased to release an update for Version 9 Stable Patch 2 (Build 245)! This update focuses on knocking down bugs discovered after the stable release, making minor adjustments to the UI to improve consistency, and introducing a myriad of small fixes to the API and its documentation to make sure that our community developers are having as smooth a time as possible.</p>

<p class="note warning"><strong>WARNING:</strong> While this is categorized as a stable release there is always a possibility of unexpected bugs or compatibility issues. As with any time you update the core software, be sure to perform a complete backup of your user data to minimize any risk of data loss (<a href="https://www.youtube.com/watch?v=OmbxMmqNNXU" rel="nofollow" target="_blank">Follow this handy guide</a>). </p>

<h2 class="border">Update Highlights</h2>
<p>The vast majority of these changes are non-controversial, and the most notable of them in the update are as follows: 
</p><ul>
    <li>We improved the appearance of the module management and setup lists, introducing smaller tag icons and improved formatting to accommodate modules with long titles and large numbers of tags.</li>
    <li>We corrected a number of edge-case issues with vision, lighting and canvas rendering, knocking out a few more rare cases where vision would be weird or inaccurate.</li>
    <li>We have resolved a number of API documentation issues, improving quality of information for our community developers. </li>
</ul> 

<p>For a comprehensive list of everything we fixed, see below! </p>
<div>
<h2 class="border">New Features</h2>
    <h3>Architecture and Infrastructure</h3>
    <ul>
        <li>Updated <code>pixi/graphics-smooth</code> to fix rectangle masks and holes. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6493" rel="nofollow" target="_blank">6493</a>)</li>
    </ul>

    <h3>The Game Canvas</h3>
    <ul>
        <li>Changed canvas outline to use <code>SmoothGraphics</code> instead of <code>LegacyGraphics</code> to correct an issue where the outline can disappear when zoomed out. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6587" rel="nofollow" target="_blank">6587</a>)</li>
    </ul>
    <h3>Interface and Applications</h3>
    <ul>
        <li>Holding Ctrl when starting a new wall will no longer chain from a previously completed wall endpoint. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6471" rel="nofollow" target="_blank">6471</a>)</li>
        <li>Changed the autocomplete attribute for filter inputs in the setup screen to be off, preventing unwanted autofill. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6514" rel="nofollow" target="_blank">6514</a>)</li>
        <li>Added a toast when a JSON import has finished, alerting users that it was successful. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6527" rel="nofollow" target="_blank">6527</a>)</li>
        <li>Ensured that icons for the various Create document buttons match the sidebar tab they are associated with. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6532" rel="nofollow" target="_blank">6532</a>)</li>
        <li>Fixed an issue where token nameplates were not rendered above target indicators. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6544" rel="nofollow" target="_blank">6544</a>)</li>
    </ul>
</div>
<div>
<h2 class="border">API Improvements</h2>

    <h3>Documents and Data</h3>
    <ul>
        <li>Corrected instances where active effects would fail to apply properly if there was a space between the + and the number being added. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6463" rel="nofollow" target="_blank">6463</a>)</li>
        <li>Corrected the <code>DefaultTokenConfig</code> object property to be of a type <code>TokenDocument</code> where previously it was not. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6542" rel="nofollow" target="_blank">6542</a>)</li>
        <li>Corrected a bug where form data would always return <code>null</code> from radio inputs with only single option. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6539" rel="nofollow" target="_blank">6539</a>)</li>
        <li>Fixed instances where <code>KeyboardManager#hasFocus</code> would miss valid <code>contenteditable</code> attributes, causing it to report a false value when it should not. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6509" rel="nofollow" target="_blank">6509</a>)</li>
    </ul>
</div>
<div>
    <h2 class="border">Documentation Improvements</h2>
    <ul>
        <li>Added documentation for missing <code>AnimationData</code> properties. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6365" rel="nofollow" target="_blank">6365</a>)</li>
        <li>Updated the documentation of <code>AmbientSoundData</code> to be accurate with its current properties. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6368" rel="nofollow" target="_blank">6368</a>)</li>
        <li>Corrected documentation on the return value of <code>Folder.createDialog</code> so it was consistent with <code>ClientDocumentMixin#createDialog</code>. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6371" rel="nofollow" target="_blank">6371</a>)</li>
        <li>Updated documentation for <code>AbstractBaseShader#vertexShader</code> so that it no longer states that subclasses must implement the <code>fragmentShader</code> field. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6405" rel="nofollow" target="_blank">6405</a>)</li>
        <li>Documentation now properly notes that <code>SoundSource#_initializeData</code> returns nothing (void) instead of returning changes. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6521" rel="nofollow" target="_blank">6521</a>)</li>
        <li>Added notes for various <code>PointSource</code> draw methods which had previously undocumented <code>null</code> returns. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6522" rel="nofollow" target="_blank">6522</a>)</li>
        <li>Corrected information for <code>PlaceableObject#vision</code> which had wrong types documented. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6524" rel="nofollow" target="_blank">6524</a>)</li>
        <li>Return type of <code>Combat#getCombatantByToken</code> and <code>Combat#getCombatantByActor</code> is now documented correctly. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6560" rel="nofollow" target="_blank">6560</a>)</li>
        <li>Fixed the return type of <code>Cards#playDialog</code> to be consistent with the documentation. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6547" rel="nofollow" target="_blank">6547</a>)</li>
    </ul>
</div>

<div>
<h2 class="border">Localization Improvements</h2>
<ul>
    <li>Properly localized the <code>html</code> tag to include the <code>lang</code> attribute. (<a href="https://github.com/foundryvtt/foundryvtt/issues/5384" rel="nofollow" target="_blank">5384</a>)</li>
    <li>Updated labels on the Grid Configuration tool to properly represent the shift-X and shift-Y fields as changing the background offset instead of grid offset. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6460" rel="nofollow" target="_blank">6460</a>)</li>
</ul>
</div>
<div>
<h2 class="border">Bug Fixes</h2>
    <h3>Documents and Data</h3>
    <ul>
        <li>Moving a feature in an actor located inside a compendium no longer duplicates the feature instead of moving it. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6407" rel="nofollow" target="_blank">6407</a>)</li>
        <li>Right clicking while moving a token with Token Drag Vision Enabled will now properly reset the visible area along with the token. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6507" rel="nofollow" target="_blank">6507</a>)</li>
        <li>Creating a compendium without a label will no longer render worlds inoperable until restart. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6569" rel="nofollow" target="_blank">6569</a>)</li>
        <li>Corrected an issue with the <code>FilePicker</code> where if the <code>type</code> is listed as optional it does not provide all file extensions as viable options, resulting in undefined file upload requests being incorrectly rejected. We improved the semantics of available <code>FilePicker</code> types by adding a new <code>any</code> type which is now the default if no type is provided and accepts any supported file extension for upload. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6386" rel="nofollow" target="_blank">6386</a>)</li>
    </ul>
    <h3>The Game Canvas</h3>
    <ul>
        <li>Fixed a PIXI related issue where Token movement could reveal FOW on closed areas with active light sources. (<a href="https://github.com/foundryvtt/foundryvtt/issues/4850" rel="nofollow" target="_blank">4850</a>)</li>
        <li>Corrected an edge case where certain wall configurations could result in the vision Polygons with artifacts due to completing the Vision sweep incorrectly. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6317" rel="nofollow" target="_blank">6317</a>)</li>
        <li>When undoing a placed object deletion, <code>keepId: true</code> is specified in order to re-create the deleted objects with the same ID that they had previously. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6384" rel="nofollow" target="_blank">6384</a>)</li>
        <li>Ensured that updating a token's sight with a macro will automatically display the new vision settings on the canvas. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6389" rel="nofollow" target="_blank">6389</a>)</li>
        <li>Saved fog will no longer override a specified unexplored fog color. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6415" rel="nofollow" target="_blank">6415</a>)</li>
        <li>Updated the torch lighting effect to be less intense on high frame rate displays. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6430" rel="nofollow" target="_blank">6430</a>)</li>
        <li>Fixed polygon drawing tool so that it is possible to place more than two segments again. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6465" rel="nofollow" target="_blank">6465</a>)</li>
        <li>Resetting a light to default settings will now properly reset the Constrained by Walls and Provides Vision properties. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6515" rel="nofollow" target="_blank">6515</a>)</li>
        <li>Fixed an issue where dark light sources were being rendered at z-index 10 instead of 0. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6530" rel="nofollow" target="_blank">6530</a>)</li>
        <li>Corrected unwanted behavior where <code>Canvas#_onDragLeftStart</code> checks active layer by exact constructor name. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6562" rel="nofollow" target="_blank">6562</a>)</li>
        <li>Ensured that <code>MeasuredTemplate</code> is properly redrawn if the type is changed. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6593" rel="nofollow" target="_blank">6593</a>)</li>
    </ul>
    
    <h3>Dice and Cards</h3>
    <ul>
    <li>Fixes an issue where imported card decks would incorrectly import their children cards, which resulted in orphaned cards. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6364" rel="nofollow" target="_blank">6364</a>)</li>
    <li>Removed the ability to deal cards from a deck embedded in a compendium. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6470" rel="nofollow" target="_blank">6470</a>)</li>
    </ul>
    
    <h3>Interface and Applications</h3>
    <ul>
        <li>Corrected an issue where attempting to schedule an audio fade out on a resource with an unknown or non-numeric duration would result in no audio playing. (<a href="https://github.com/foundryvtt/foundryvtt/issues/5869" rel="nofollow" target="_blank">5869</a>)</li>
        <li>Fixed a formatting issue that would cause long text on window tabs to overflows the flex container instead of properly wrapping the text. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6375" rel="nofollow" target="_blank">6375</a>)</li>
        <li>Creating a static representation of an animated token image in the Combat Tracker will no longer fail if the game canvas is not available or is disabled. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6394" rel="nofollow" target="_blank">6394</a>)</li>
        <li>Adjusted formatting and styles of the module management window to improve the display of modules with multiple tags and long titles. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6422" rel="nofollow" target="_blank">6422</a>)</li>
        <li>Expanding module descriptions will no longer ignore filters when managing modules. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6427" rel="nofollow" target="_blank">6427</a>)</li>
        <li>Ensured that dropdown menus and certain dialog boxes would display properly on Firefox with Dark mode enabled. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6461" rel="nofollow" target="_blank">6461</a>)</li>
        <li>Fixed a minor styling issue that would randomly cause the update notes UI window to be unusually truncated. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6466" rel="nofollow" target="_blank">6466</a>)</li>
        <li>Ensured that attempting to warn a user that their version of electron is too old will produce the expected warning instead of an error. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6474" rel="nofollow" target="_blank">6474</a>)</li>
        <li>Corrected an issue where <code>FormDataExtended</code> was not processing tinymce editor instances as <code>dtype</code> string, causing them to return <code>null</code> instead of an empty string if their content was blank. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6477" rel="nofollow" target="_blank">6477</a>)</li>
        <li>Fixed an issue where some input types can obtain focus via tab input field selection, but would not be treated as focused by the keyboard manager. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6478" rel="nofollow" target="_blank">6478</a>)</li>
        <li>Fixed <code>CONFIG.fontFamilies</code> to include fonts which are universally loaded into all web browsers. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6516" rel="nofollow" target="_blank">6516</a>)</li>
        <li>Moved a misplaced arrow icon out of the guns folder in the foundry core icons library. (<a href="https://github.com/foundryvtt/foundryvtt/issues/6580" rel="nofollow" target="_blank">6580</a>)</li>
        <li>Refactored HTML elements that were not presently within a landmark element to be so. (<a href="https://github.com/foundryvtt/foundryvtt/issues/5383" rel="nofollow" target="_blank">5383</a>)</li>
        <li>Assigned a proper label to the chat <code>textarea</code> and corrected an invalid property in its html. (<a href="https://github.com/foundryvtt/foundryvtt/issues/5503" rel="nofollow" target="_blank">5503</a>)</li>
        </ul>
</div>